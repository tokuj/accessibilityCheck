# Implementation Plan

## Task 1: 環境変数設定ファイルの作成

- [ ] 1.1 (P) 本番環境用の環境変数ファイルを作成する
  - GCRバックエンドのエンドポイントURLを設定するファイルを作成
  - Viteビルド時に読み込まれる形式で記述
  - プレースホルダー値を設定（実際のURLはデプロイ後に更新）
  - _Requirements: 2.1, 2.2, 2.3_

- [ ] 1.2 (P) 環境変数のテンプレートファイルを作成する
  - 開発者向けの設定例を記載
  - 開発環境と本番環境の違いをコメントで説明
  - リポジトリにコミット可能な形式で作成
  - _Requirements: 5.1, 5.2_

## Task 2: APIクライアントのタイムアウト・エラーハンドリング実装

- [ ] 2.1 API通信にタイムアウト処理を追加する
  - 分析処理の長時間実行に対応するタイムアウト設定を追加
  - 標準のAbortSignal APIを使用してリクエストを制御
  - タイムアウト時に適切なエラーをスローする仕組みを実装
  - _Requirements: 4.2_

- [ ] 2.2 エラー種別に応じたメッセージ生成を実装する
  - タイムアウトエラーの判定とユーザー向けメッセージ
  - ネットワーク接続エラーの判定とメッセージ
  - HTTPステータスコードに応じたエラー分類（4xx/5xx）
  - 既存のエラーハンドリングパターンを拡張
  - _Requirements: 4.1, 4.2, 4.3_

## Task 3: バックエンドCORS設定の更新

- [ ] 3.1 デプロイスクリプトにCORS許可オリジン設定を追加する
  - 環境変数ALLOWED_ORIGINSをデプロイ時に設定
  - フロントエンドのホスティングURLをプレースホルダーで設定
  - 既存のデプロイフローを維持しながら設定を追加
  - _Requirements: 3.1, 3.3_

## Task 4: 環境設定ドキュメントの作成

- [ ] 4.1 (P) フロントエンド環境設定のドキュメントを作成する
  - 環境変数の概要と設定方法
  - ローカル開発環境のセットアップ手順
  - 本番環境用ビルドの実行方法
  - GCRバックエンドへの接続設定
  - トラブルシューティング（CORS、接続エラー等）
  - _Requirements: 5.1, 5.2, 5.3_

## Task 5: 統合テストと動作確認

- [ ] 5.1 本番ビルドでの環境変数埋め込みを確認する
  - ビルド成果物に環境変数が正しく埋め込まれることを検証
  - 開発環境でのプロキシ動作が維持されることを確認
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3_

- [ ] 5.2 エラーハンドリングの動作テストを実施する
  - タイムアウト発生時のエラー表示確認
  - ネットワークエラー時のメッセージ表示確認
  - APIエラーレスポンス時の挙動確認
  - _Requirements: 4.1, 4.2, 4.3_

- [ ] 5.3 CORS設定の動作確認を行う
  - フロントエンドからGCRバックエンドへのクロスオリジンリクエスト確認
  - CORSエラー発生時のエラーメッセージ表示確認
  - _Requirements: 3.1, 3.2, 3.3_
