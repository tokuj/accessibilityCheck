# Requirements Document

## Introduction

本仕様は、アクセシビリティチェックアプリケーションにおけるダウンロード機能の拡張を定義する。現在、詳細結果のCSVダウンロードのみ対応しているが、以下の2つの新機能を追加する：

1. **AI総評CSVダウンロード**: AI総評に含まれる問題点と修正方法をCSV形式でエクスポート
2. **レポート全体PDFダウンロード**: 画面に表示されているレポート全体をPDFとしてダウンロード

これにより、ユーザーは分析結果を多様な形式で保存・共有できるようになる。

## Requirements

### Requirement 1: AI総評CSVダウンロード

**Objective:** As a 開発者/QAエンジニア, I want AI総評の問題点と修正方法をCSV形式でダウンロードしたい, so that チームとの共有やタスク管理ツールへのインポートが容易になる

#### Acceptance Criteria

1. When ユーザーがAI総評CSVダウンロードボタンをクリックする, the フロントエンドアプリケーション shall CSVファイルのダウンロードを開始する
2. The CSVファイル shall 以下のカラムを含む: 問題番号, 何が起きているか, 修正に必要なもの, どう修正するか
3. The CSVファイル shall UTF-8 BOM付きエンコーディングで出力される（Excel互換）
4. If AI総評データが存在しない, then the フロントエンドアプリケーション shall ダウンロードボタンを非活性状態で表示する
5. The ダウンロードボタン shall AI総評セクション内の見やすい位置に配置される
6. The ファイル名 shall 分析対象URLと日時を含む命名規則に従う（例: `ai-summary_example-com_2024-01-15.csv`）

### Requirement 2: レポート全体PDFダウンロード

**Objective:** As a 開発者/QAエンジニア, I want 画面に表示されているレポート全体をPDFでダウンロードしたい, so that アクセシビリティ監査結果をドキュメントとして保存・報告できる

#### Acceptance Criteria

1. When ユーザーがPDFダウンロードボタンをクリックする, the フロントエンドアプリケーション shall 現在表示中のレポート全体をPDF形式で生成しダウンロードを開始する
2. The PDFファイル shall 画面に表示されているすべての要素（スコア、詳細結果、AI総評、スクリーンショット等）を含む
3. The PDFファイル shall 背景色を除外し、印刷に適したスタイルで出力される
4. While PDF生成中, the フロントエンドアプリケーション shall 進行状況インジケーターを表示する
5. If PDF生成に失敗した場合, then the フロントエンドアプリケーション shall エラーメッセージを表示し、再試行オプションを提供する
6. The ファイル名 shall 分析対象URLと日時を含む命名規則に従う（例: `a11y-report_example-com_2024-01-15.pdf`）
7. The PDFダウンロードボタン shall レポートページの目立つ位置（ヘッダー付近）に配置される

### Requirement 3: ダウンロード機能の共通仕様

**Objective:** As a ユーザー, I want 一貫性のあるダウンロード体験を得たい, so that 迷わずに必要なファイルを取得できる

#### Acceptance Criteria

1. The すべてのダウンロードボタン shall 統一されたアイコンとスタイルで表示される
2. When ダウンロードが完了した, the フロントエンドアプリケーション shall 成功通知を表示する
3. The ダウンロード機能 shall モバイルブラウザでも正常に動作する
4. If ブラウザがダウンロードをブロックした場合, then the フロントエンドアプリケーション shall ユーザーに適切なガイダンスを表示する
